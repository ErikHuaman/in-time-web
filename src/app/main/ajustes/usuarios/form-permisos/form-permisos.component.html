<div class="flex flex-col gap-6">
  <p-table
    [value]="listaModulos"
    sortField="grupoModulo.nombre"
    sortMode="single"
    [scrollable]="true"
    scrollHeight="400px"
    rowGroupMode="subheader"
    groupRowsBy="grupoModulo.nombre"
    [tableStyle]="{ 'min-width': '60rem' }"
  >
    <ng-template #header>
      <tr>
        <th><div class="text-center text-xs uppercase">MÃ³dulo</div></th>
        <th class="w-28">
          <div class="text-center text-xs uppercase">Todos</div>
        </th>
        <th class="w-28">
          <div class="text-center text-xs uppercase">Leer</div>
        </th>
        <th class="w-28">
          <div class="text-center text-xs uppercase">Crear</div>
        </th>
        <th class="w-28">
          <div class="text-center text-xs uppercase">Editar</div>
        </th>
        <th class="w-28">
          <div class="text-center text-xs uppercase">Eliminar</div>
        </th>
      </tr>
    </ng-template>
    <ng-template #groupheader let-item>
      <tr pRowGroupHeader>
        <td colspan="5">
          <div class="flex items-center gap-2">
            <span class="text-sm font-bold uppercase">{{
              item.grupoModulo.nombre
            }}</span>
          </div>
        </td>
      </tr>
    </ng-template>
    <!-- <ng-template #groupfooter let-customer>
        <tr>
            <td colspan="5" class="text-right font-bold pr-12">
                Total Customers: {{calculateCustomerTotal(customer.representative.name)}}
            </td>
        </tr>
    </ng-template> -->
    <ng-template #body let-item let-rowIndex="rowIndex">
      <tr>
        <td>
          <span class="text-sm">{{ item.nombre }}</span>
        </td>
        <td>
          <div class="flex justify-center items-center gap-2">
            <p-checkbox
              [(ngModel)]="item.permisos.todos"
              [binary]="true"
              (ngModelChange)="selectAll(item.permisos)"
            />
          </div>
        </td>
        <td>
          <div class="flex justify-center items-center gap-2">
            <p-checkbox
              [(ngModel)]="item.permisos.leer"
              [binary]="true"
              (ngModelChange)="checkMarkRead($event, item.permisos)"
            />
          </div>
        </td>
        <td>
          <div class="flex justify-center items-center gap-2">
            <p-checkbox
              [(ngModel)]="item.permisos.crear"
              [binary]="true"
              (ngModelChange)="checkMarkAll(item.permisos)"
            />
          </div>
        </td>
        <td>
          <div class="flex justify-center items-center gap-2">
            <p-checkbox
              [(ngModel)]="item.permisos.editar"
              [binary]="true"
              (ngModelChange)="checkMarkAll(item.permisos)"
            />
          </div>
        </td>
        <td>
          <div class="flex justify-center items-center gap-2">
            <p-checkbox
              [(ngModel)]="item.permisos.eliminar"
              [binary]="true"
              (ngModelChange)="checkMarkAll(item.permisos)"
            />
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
  <div class="flex justify-end gap-4" formGroupName="usuario">
    <p-button
      severity="info"
      size="small"
      [label]="'Guardar'"
      (onClick)="guardar()"
    />
  </div>
</div>
